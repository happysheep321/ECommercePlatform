## ✅ 一、初步阶段（目标：**用户安全 + 基础权限结构**）

### 🎯 目标：

- 建立基础安全功能
- 具备账户管理与登录控制能力
- 邮箱验证码机制成为系统可信入口
- 开始权限结构重构，为后续扩展打地基

### 📌 要做的事（按优先级）：

#### 用户侧：

1. ✅ 实现邮箱验证码发送、缓存、验证逻辑（含 Redis 缓存 + 限流 + 邮件发送）
2. ✅ 找回密码功能（验证码验证通过后修改密码）
3. ✅ 登录态下修改密码（含当前密码验证）
4. ✅ 用户状态控制（IsEnabled 字段 + 登录校验）
5. ✅ 用户注销（IsDeleted 字段 + 登录逻辑中排除）

#### 后台侧：

1. ✅ 用户分页列表 + 基本信息查看（支持关键词搜索、分页）
2. ✅ 后台启用/禁用用户接口
3. ✅ 用户详情（包含角色、地址、登录记录）

#### 权限体系：

1. ✅ 重构角色-权限数据结构，支持持久化存储（初步不接 UI，仅实现表结构和数据）

------

## 🛠️ 二、修改阶段（目标：**账号管理 + 权限体系成型**）

### 🎯 目标：

- 实现账号信息维护功能
- 完善角色/权限模型
- 提升用户体验和后台灵活性

### 📌 要做的事：

#### 用户侧：

1. ✅ 邮箱绑定修改（邮箱验证码验证 + 更新）
2. ✅ 默认收货地址设置（已有结构基础上添加 IsDefault 字段，变更逻辑保持唯一）

#### 后台侧：

1. ✅ 支持管理员强制修改用户角色
2. ✅ 支持管理员重置用户密码（含权限控制）
3. ✅ 用户状态后台接口（与用户登录联动）

#### 权限体系：

1. ✅ 实现 RBAC 权限模型（用户-角色-权限三者关联）
2. ✅ 管理员角色分配接口（支持增/删角色）
3. ✅ 基础权限资源维护接口（可配置菜单、按钮、接口）

------

## 🚀 三、最终阶段（目标：**可运维、可扩展、体验提升**）

### 🎯 目标：

- 支持多端登录与现代化体验
- 加强安全审计与权限可视化
- 支撑未来平台化运营能力

### 📌 要做的事：

#### 用户侧：

1. ✅ 第三方登录接入（优先 GitHub/Google，支持绑定已有账户）
2. ✅ 优化注册流程（可选预设角色、注册邀请码等）

#### 后台侧：

1. ✅ 日志审计（记录重要操作，区分用户与管理员）
2. ✅ 用户导出功能（Excel/CSV）
3. ✅ 接口权限控制（支持菜单、按钮级权限前后端联动）

------

## 🔁 补充建议：每阶段结束前进行一次回归测试和自测验收

- **基础测试清单**：
  - 邮箱验证码是否生效、是否可复用、是否超时
  - 登录/找回/修改密码流程是否畅通，状态逻辑是否生效
  - 是否存在安全漏洞（如密码绕过、验证码重复使用）
  - 后台操作是否产生正确副作用（角色是否替换成功、用户是否能登录）
- **代码结构建议**：
  - 邮箱发送模块使用接口 + 注入（方便替换为其他 SMTP 或 API）
  - 权限模块设计参考“声明式权限”（如基于特性或策略）便于统一控制