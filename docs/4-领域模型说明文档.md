## 🧩 分布式电商系统领域模型说明文档

本系统按照领域驱动设计（DDD）原则，将整个分布式电商系统划分为若干核心领域，每个领域拥有其独立的**聚合根（Aggregate Root）**及相关子实体。核心领域包括：用户、商品、订单、支付、库存、购物车。

------

### 🧍 用户聚合（User Aggregate）

- **User（用户）**：系统中的注册用户，包含用户名、邮箱、加密后的密码等基本信息。
- **Role（角色）**：定义用户的权限类型，包括“买家”、“卖家”、“管理员”等。
- ✅ **关系说明**：一个用户可关联多个角色（多对多关系）。

------

### 🛒 购物车聚合（Cart Aggregate）

- **Cart（购物车）**：用户的临时商品收集容器，尚未转为订单。
- **CartItem（购物车项）**：购物车中加入的每一项商品 SKU，包含数量、商品ID、SKU ID 等。
- ✅ **关系说明**：
  - 每个用户拥有一个购物车（一对一）；
  - 一个购物车可包含多个购物车项（CartItem）（一对多）；
  - 每个购物车项关联一个商品 SKU（多对一）。

------

### 📦 商品聚合（Product Aggregate）

- **Product（商品）**：平台上架的商品，例如“苹果手机”，包含名称、描述、所属分类等信息。
- **SKU（库存单元）**：商品的具体销售规格，如“黑色 128G”。
- **Category（分类）**：商品的多级分类信息。
- ✅ **关系说明**：
  - 一个商品属于一个分类（多对一）；
  - 一个商品可包含多个 SKU（一对多）。

------

### 📑 订单聚合（Order Aggregate）

- **Order（订单）**：用户下单后的交易记录，包含买家信息、商品明细、总金额、收货地址、订单状态等。
- **OrderItem（订单项）**：订单中每一项商品的购买信息。
- **Address（地址）**：用户的收货信息，包括姓名、电话、详细地址等。
- **OrderStatus（订单状态）**：订单所处状态，如“已创建”、“已支付”、“已发货”、“已完成”、“已取消”等。
- ✅**关系说明**：
  - 一个订单包含多个订单项（OrderItem）（一对多）；
  - 一个订单关联一个收货地址（多对一）；
  - 一个订单仅有一个状态（多对一）；
  - 一个订单由一个用户创建（多对一）。

------

### 💰 支付聚合（Payment Aggregate）

- **Payment（支付记录）**：某一订单的支付数据，记录支付金额、时间、方式等。
- **PaymentStatus（支付状态）**：如“待支付”、“支付成功”、“支付失败”、“已退款”等。
- ✅ **关系说明**：
  - 一条支付记录对应一个订单（多对一）；
  - 每条支付记录具备唯一支付状态（多对一）。

------

### 🏭 库存聚合（Inventory Aggregate）

- **Inventory（库存）**：SKU 对应的库存数据，包含“可用库存”和“锁定库存”。
- **InventoryLog（库存日志）**：库存变更明细，如“下单锁定10件”、“发货扣减10件”等”。
- ✅ **关系说明**：
  - 每个 SKU 对应一条库存记录（一对一）；
  - 一条库存记录可关联多个库存日志（一对多）。

------

## 🧠 聚合模型概览表

| 聚合名称 | 聚合根      | 关联实体                         | 示例说明                   |
| -------- | ----------- | -------------------------------- | -------------------------- |
| 用户     | `User`      | `Role`                           | 用户可分配不同角色         |
| 购物车   | `Cart`      | `CartItem`、`ProductSku`         | 用户可添加多种商品进购物车 |
| 商品     | `Product`   | `Category`、`SKU`                | 手机商品有多个规格项       |
| 订单     | `Order`     | `OrderItem`、`Address`、`Status` | 记录订单明细与状态         |
| 支付     | `Payment`   | `PaymentStatus`                  | 表示订单的支付情况         |
| 库存     | `Inventory` | `InventoryLog`                   | 跟踪 SKU 库存变更情况      |