# ğŸ“Œ é¡¹ç›®åç§°ï¼šã€Šåˆ†å¸ƒå¼ç”µå•†å¹³å°ã€‹ï¼ˆE-Commerce Platformï¼‰

## 1. ç³»ç»Ÿæ¶æ„æ€»è§ˆ
### 1.1 å•ä½“æ¶æ„å‘å¾®æœåŠ¡æ¼”è¿›å›¾ï¼ˆæŒ‰ DDD æ¨¡å—æ‹†åˆ†ï¼‰

> è¯´æ˜ï¼šå±•ç¤ºä»å•ä½“ç»“æ„é€æ­¥æ‹†åˆ†ä¸ºå¾®æœåŠ¡çš„å…¨è¿‡ç¨‹ï¼ŒåŸºäº DDD ä¸‰å±‚ç»“æ„ï¼ˆåº”ç”¨å±‚ã€é¢†åŸŸå±‚ã€åŸºç¡€è®¾æ–½å±‚ï¼‰è¿›è¡Œæ¨¡å—åˆ’åˆ†ï¼Œæ¯ä¸ªæœåŠ¡å…·å¤‡ç‹¬ç«‹éƒ¨ç½²èƒ½åŠ›ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å•ä½“åº”ç”¨ API å±‚ï¼ˆASP.NET Coreï¼‰                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    åº”ç”¨æœåŠ¡å±‚ï¼ˆApplicationï¼‰                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  å•†å“æœåŠ¡ï¼ˆProductAppServiceï¼‰             ğŸ”œ ProductServiceï¼ˆRESTï¼‰â”‚
â”‚ â”‚ å·²æ”¯æŒæ‹†åˆ†   â”‚  - APIï¼š/api/products                                 â”‚
â”‚ â”‚ æ”¯æŒç‹¬ç«‹éƒ¨ç½² â”‚  - èšåˆæ ¹ï¼šProductAggregate                            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  - ç¼“å­˜ç­–ç•¥ï¼šRedis                                   â”‚
â”‚                                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  ç”¨æˆ·æœåŠ¡ï¼ˆUserAppServiceï¼‰               ğŸ”œ AuthService/UserServiceï¼ˆRESTï¼‰â”‚
â”‚ â”‚ å·²æ”¯æŒæ‹†åˆ†   â”‚  - è®¤è¯æœºåˆ¶ï¼šJWT + OAuth                               â”‚
â”‚ â”‚ æ”¯æŒç‹¬ç«‹éƒ¨ç½² â”‚  - å¯æ¥å…¥ IdentityServer4                              â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”‚                                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  è®¢å•æœåŠ¡ï¼ˆOrderAppServiceï¼‰             ğŸ”œ OrderServiceï¼ˆREST + æ¶ˆæ¯ï¼‰â”‚
â”‚ â”‚ æ‹†åˆ†ä¼˜å…ˆçº§é«˜ â”‚  - èšåˆï¼šè®¢å•ã€è®¢å•é¡¹ã€çŠ¶æ€æœº                             â”‚
â”‚ â”‚ å¯äº‹ä»¶é©±åŠ¨åŒ– â”‚  - æ”¯æŒ Saga æ¨¡å¼ä¸ Outbox æ¨¡å¼                         â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”‚                                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  è´­ç‰©è½¦æœåŠ¡ï¼ˆCartAppServiceï¼‰           ğŸ”œ CartServiceï¼ˆRedis + RESTï¼‰â”‚
â”‚ â”‚ å·²æ”¯æŒæ‹†åˆ†   â”‚  - Redisç»“æ„ï¼šcart:{userId}                           â”‚
â”‚ â”‚ è½»é‡çº§æ— æŒä¹…åŒ– â”‚ - é«˜å¹¶å‘ä¸‹é€šè¿‡ç½‘å…³è½¬å‘æ”¯æŒæ‰©å±•æ€§                         â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   é¢†åŸŸæ¨¡å‹å±‚ï¼ˆDomainï¼‰                                 â”‚
â”‚ - ProductAggregateï¼ˆå¯¹åº”å•†å“æœåŠ¡ï¼‰                                     â”‚
â”‚ - UserAggregateï¼ˆå¯¹åº”ç”¨æˆ·æœåŠ¡ï¼‰                                        â”‚
â”‚ - OrderAggregateï¼ˆå¯¹åº”è®¢å•æœåŠ¡ï¼‰                                       â”‚
â”‚ - å€¼å¯¹è±¡ï¼ˆåœ°å€ã€ä»·æ ¼ã€åº“å­˜ç­‰ï¼‰å»ºè®®æŠ½ç¦»ä¸ºå…±äº«å†…æ ¸æ¨¡å— SharedKernel             â”‚
â”‚ - æ”¯æŒé¢†åŸŸäº‹ä»¶ï¼ˆDomain Eventsï¼‰ï¼šåŸºäº Mediator æˆ–æ¶ˆæ¯é˜Ÿåˆ—å®ç°              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  åŸºç¡€è®¾æ–½å±‚ï¼ˆInfrastructureï¼‰                          â”‚
â”‚ - Repositoryï¼ˆEF Core å®ç°ï¼‰ â†’ å„æœåŠ¡ç‹¬ç«‹æŒä¹…åŒ–                          â”‚
â”‚ - Redis ç¼“å­˜ â†’ å•†å“/è´­ç‰©è½¦ç¼“å­˜                                          â”‚
â”‚ - æ—¥å¿—ç»„ä»¶ï¼ˆSerilogï¼‰ â†’ æ”¯æŒé›†ä¸­æ—¥å¿—å¹³å°æ¥å…¥ï¼ˆå¦‚ ELKï¼‰                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   å…¬å…±æœåŠ¡æ¨¡å—ï¼ˆCommonï¼‰                               â”‚
â”‚ - æ—¥å¿—æœåŠ¡ï¼ˆSerilog + ELKï¼‰                                           â”‚
â”‚ - ç¼“å­˜æœåŠ¡ï¼ˆRedis é›†ç¾¤ï¼‰                                               â”‚
â”‚ - é…ç½®ä¸­å¿ƒï¼ˆåŸºäº .NET æŠ½è±¡å±‚å°è£… Apollo / Consulï¼‰                       â”‚
â”‚ - ç½‘å…³æœåŠ¡ï¼ˆæ¨è YARP / Ocelot å®ç°ï¼‰                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

------

## 2. å¾®æœåŠ¡æ‹†åˆ†æ–¹æ¡ˆ

### 2.1 æ‹†åˆ†å»ºè®®æ±‡æ€»

| æ¨¡å—       | æ‹†åˆ†ä¼˜å…ˆçº§ | å•ä½“å†…ä½ç½®        | é€šä¿¡æ–¹å¼     | æ¨èæŠ€æœ¯æ–¹æ¡ˆ                                       | è¡ç”Ÿä¼˜åŒ–å»ºè®®                        |
| ---------- | ---------- | ----------------- | ------------ | -------------------------------------------------- | ----------------------------------- |
| å•†å“æœåŠ¡   | é«˜         | ProductAppService | REST + Redis | ç‹¬ç«‹æ•°æ®åº“ã€ç¼“å­˜æœºåˆ¶ã€é™æµæ§åˆ¶                     | æ”¯æŒç°åº¦å‘å¸ƒã€ä½¿ç”¨ CDN è¿›è¡Œå›¾ç‰‡æ‰˜ç®¡ |
| ç”¨æˆ·æœåŠ¡   | ä¸­         | UserAppService    | REST + JWT   | IdentityServer4 / OAuth2ã€ç»Ÿä¸€è®¤è¯æˆæƒã€JWTæœºåˆ¶    | å¯æ‰©å±• RBAC æƒé™æ¨¡å‹                |
| è®¢å•æœåŠ¡   | é«˜         | OrderAppService   | REST + MQ    | Saga æ¨¡å¼ã€Outbox æ¨¡å¼ã€çŠ¶æ€æœºå»ºæ¨¡ã€äº‹ä»¶é©±åŠ¨ä¸€è‡´æ€§ | å¼•å…¥ RabbitMQ åŠè¡¥å¿æœºåˆ¶            |
| è´­ç‰©è½¦æœåŠ¡ | ä¸­         | CartAppService    | Redis + REST | çº¯å†…å­˜å¼ Redis æ¨¡å‹ï¼Œæ— æ•°æ®åº“                      | è®¾ç½® TTL åŠ Session é™åˆ¶é˜²é›ªå´©      |
| å…¬å…±æœåŠ¡   | åŸºç¡€       | å„æ¨¡å—é€šç”¨ç»„ä»¶    | å†…éƒ¨å…±äº«     | Serilogã€é…ç½®ä¸­å¿ƒã€æœåŠ¡å‘ç°ï¼ˆConsulï¼‰              | æ¨èç»Ÿä¸€éƒ¨ç½²ä»¥ä¾¿ç»Ÿä¸€ç®¡ç†            |

------

### 2.2 æ‹†åˆ†æ¨èé¡ºåºåŠä¾æ®

1. **è´­ç‰©è½¦æœåŠ¡**ï¼šæœåŠ¡è½»é‡ï¼Œæ— æ•°æ®åº“ä¾èµ–ï¼Œæ‹†åˆ†æˆæœ¬ä½ã€‚
2. **å•†å“æœåŠ¡**ï¼šèšåˆç»“æ„æ¸…æ™°ï¼Œç¼“å­˜æ–¹æ¡ˆæ˜ç¡®ï¼Œæ˜“äºç‹¬ç«‹éƒ¨ç½²ã€‚
3. **ç”¨æˆ·æœåŠ¡**ï¼šéœ€ç»Ÿä¸€å¤„ç†è®¤è¯é€»è¾‘ï¼Œå¯ç»“åˆæƒé™ç³»ç»Ÿåˆ†æ­¥æŠ½ç¦»ã€‚
4. **è®¢å•æœåŠ¡**ï¼šæ ¸å¿ƒäº¤æ˜“é€»è¾‘é›†ä¸­ï¼Œå¤æ‚åº¦é«˜ä½†ç‹¬ç«‹åæ”¶ç›Šæ˜¾è‘—ã€‚
5. **å…¬å…±æœåŠ¡æ¨¡å—**ï¼šæ—¥å¿—ã€é…ç½®ã€ç¼“å­˜ç­‰æœåŠ¡éœ€ä¼˜å…ˆæŠ½ç¦»ä»¥æ”¯æŒå…¨å±€è¿è¡Œç¯å¢ƒã€‚

## 3. æ¨¡å—åˆ’åˆ†è¯´æ˜

| æ¨¡å—åç§°         | èŒè´£èŒƒå›´                                           | ä¸»è¦ç»„ä»¶æˆ–å­æ¨¡å—                                             |
| ---------------- | -------------------------------------------------- | ------------------------------------------------------------ |
| ç”¨æˆ·è®¤è¯æ¨¡å—     | ç”¨æˆ·æ³¨å†Œç™»å½•ã€èº«ä»½è®¤è¯ä¸æƒé™ç®¡ç†                   | AccountServiceã€JWT ç®¡ç†ã€IdentityServer4 é›†æˆ               |
| å•†å“ä¸­å¿ƒæ¨¡å—     | å•†å“ä¿¡æ¯ã€åˆ†ç±»ã€SKUã€å›¾ç‰‡å­˜å‚¨ä¸è®¿é—®æ§åˆ¶            | ProductServiceã€CategoryServiceã€SKUServiceã€OSS ç®¡ç†ç»„ä»¶    |
| è´­ç‰©è½¦ï¼è®¢å•æ¨¡å— | ç”¨æˆ·è´­ç‰©æµç¨‹ã€è®¢å•ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€ä¿ƒé”€ç­–ç•¥ä¸æ´»åŠ¨å¤„ç† | CartServiceã€OrderServiceã€PromotionServiceã€è®¢å•äº‹ä»¶å¤„ç†å™¨  |
| æ”¯ä»˜æ¨¡å—         | æ”¯ä»˜è¯·æ±‚å‘èµ·ã€å›è°ƒé€šçŸ¥ã€é€€æ¬¾å¤„ç†ä¸è´¦åŠ¡æ ¸å¯¹         | PaymentServiceã€CallbackHandlerã€ReconciliationScheduler     |
| åº“å­˜æ¨¡å—         | å®æ—¶åº“å­˜æŸ¥è¯¢ã€é”å®šä¸é‡Šæ”¾ã€é¢„è­¦æœºåˆ¶                 | InventoryServiceã€åº“å­˜é”å®šæœåŠ¡ã€åº“å­˜æ—¥å¿—è®°å½•ç»„ä»¶             |
| åå°ç®¡ç†æ¨¡å—     | è¿ç»´ç®¡ç†å¹³å°ï¼šå•†å“ã€è®¢å•ã€ç”¨æˆ·ã€ç»Ÿè®¡æŠ¥è¡¨           | AdminControllerã€DashboardServiceã€æ•°æ®æŠ¥è¡¨ç”ŸæˆæœåŠ¡          |
| é€šç”¨æ”¯æ’‘æ¨¡å—     | ç³»ç»Ÿé€šç”¨èƒ½åŠ›æ”¯æ’‘ï¼šæ—¥å¿—ã€ç¼“å­˜ã€é…ç½®ã€æ¶ˆæ¯ã€é€šçŸ¥     | LoggingModuleã€CacheModuleã€ConfigModuleã€MqModuleã€Notification |
| åŸºç¡€è®¾æ–½æ¨¡å—     | æŒä¹…åŒ–å±‚ä¸é›†æˆè®¾æ–½ï¼šæ•°æ®åº“ã€ç¼“å­˜ã€æ¶ˆæ¯é˜Ÿåˆ—         | DbContextï¼ˆEF Coreï¼‰ã€RedisClientã€MqProducer / Consumer     |
| æ¥å…¥ä¸å®‰å…¨æ¨¡å—   | API ç½‘å…³ã€é™æµç­–ç•¥ã€å®‰å…¨ç­–ç•¥ï¼ˆå¦‚è·¨åŸŸï¼‰             | GatewayConfigã€RateLimitMiddlewareã€CorsMiddleware           |

## 4. æ¶æ„å¯è§†åŒ–ç»„ä»¶å›¾ï¼ˆUMLï¼‰

å¯ä½¿ç”¨ Mermaidã€Draw.io ç­‰å·¥å…·ç»˜åˆ¶æ¨¡å—ä¾èµ–å›¾ï¼Œä»¥å¢å¼ºæ¶æ„ç›´è§‚æ€§ã€‚å¦‚ä¸‹ä¸º Mermaid ç¤ºä¾‹ï¼š

```mermaid
graph TD
  subgraph æ ¸å¿ƒä¸šåŠ¡
    U[ç”¨æˆ·è®¤è¯æ¨¡å—] -->|é‰´æƒ| A[æ”¯ä»˜æ¨¡å—]
    U -->|ä¸‹å•| O[è´­ç‰©è½¦/è®¢å•æ¨¡å—]
    O -->|å‡åº“å­˜| I[åº“å­˜æ¨¡å—]
    O -->|è°ƒèµ·æ”¯ä»˜| A
    A -->|æ”¯ä»˜å›è°ƒ| O
  end

  subgraph ç®¡ç†åå°
    B[åå°ç®¡ç†æ¨¡å—] --> U
    B --> P[å•†å“ä¸­å¿ƒæ¨¡å—]
    B --> O
  end

  subgraph æ”¯æ’‘æœåŠ¡
    L[æ—¥å¿—æ¨¡å—] --> O
    L --> P
    C[é…ç½®æ¨¡å—] --> O
    MQ[æ¶ˆæ¯é˜Ÿåˆ—] --> O
  end

```
